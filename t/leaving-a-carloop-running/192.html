<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Leaving a Carloop running - Carloop Community</title>
    <meta name="description" content="Has anyone any experience leaving a Carloop running in a parked vehicle? 
I want to deploy my TPMS eliminator app and leave it plugged in but am concerned about killing my car’s battery. 
My next question would be, any r&amp;hellip;">
    <meta name="generator" content="Discourse 3.3.0.beta1-dev - https://github.com/discourse/discourse version e84d462e2804bde1e49fae2c55eecd329dc73dc0">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/5d0dc9f48a4fa5171a3a95c8befa000d9f0fe88b_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/f03d9faa7e5bd5b8a589b4ee5784e6678991578a_2_180x180.png">
<meta name="theme-color" media="all" content="#ffffff">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
<link rel="canonical" href="192.html">

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Carloop Community Search">

    <link href="../../stylesheets/color_definitions_base__1_c9899b2a42d6bd619c29b433a9ef7a3953a01da1.css?__ws=community.carloop.io" media="all" rel="stylesheet" class="light-scheme">

  <link href="../../stylesheets/desktop_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="desktop">



  <link href="../../stylesheets/chat_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="chat">
  <link href="../../stylesheets/checklist_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="checklist">
  <link href="../../stylesheets/discourse-details_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="discourse-details">
  <link href="../../stylesheets/discourse-lazy-videos_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="discourse-lazy-videos">
  <link href="../../stylesheets/discourse-local-dates_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="discourse-local-dates">
  <link href="../../stylesheets/discourse-narrative-bot_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="discourse-narrative-bot">
  <link href="../../stylesheets/discourse-presence_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="discourse-presence">
  <link href="../../stylesheets/docker_manager_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="docker_manager">
  <link href="../../stylesheets/footnote_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="footnote">
  <link href="../../stylesheets/poll_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="poll">
  <link href="../../stylesheets/spoiler-alert_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="spoiler-alert">
  <link href="../../stylesheets/chat_desktop_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="chat_desktop">
  <link href="../../stylesheets/poll_desktop_7659a6af5bea9aaa0d00bcc5111c495874284faf.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="poll_desktop">

  <link href="../../stylesheets/desktop_theme_1_68ec8432d72346d143d3760e6bc02ea5b1bbe8ac.css?__ws=community.carloop.io" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="1" data-theme-name="with top headers">

    
    <meta id="data-ga-universal-analytics" data-tracking-code="UA-75724305-1" data-json="{&quot;cookieDomain&quot;:&quot;auto&quot;}" data-auto-link-domains="">

  <link rel="preload" href="../../assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.js" as="script" data-discourse-entrypoint="google-universal-analytics-v3" nonce="QFOFI5173DO3nwNLXqmHRbSoj">
<script defer="" src="../../assets/google-universal-analytics-v3-08add7ec997ab472fcd9f821d32ff7caf4b8b9a5de2ec18ca723a040be07a098.js" data-discourse-entrypoint="google-universal-analytics-v3" nonce="QFOFI5173DO3nwNLXqmHRbSoj"></script>


        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Leaving a Carloop running&#39;" href="192.rss">
    <meta property="og:site_name" content="Carloop Community">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/uploads/default/original/1X/f03d9faa7e5bd5b8a589b4ee5784e6678991578a.png">
<meta property="og:image" content="/uploads/default/original/1X/f03d9faa7e5bd5b8a589b4ee5784e6678991578a.png">
<meta property="og:url" content="/t/leaving-a-carloop-running/192">
<meta name="twitter:url" content="/t/leaving-a-carloop-running/192">
<meta property="og:title" content="Leaving a Carloop running">
<meta name="twitter:title" content="Leaving a Carloop running">
<meta property="og:description" content="Has anyone any experience leaving a Carloop running in a parked vehicle?  I want to deploy my TPMS eliminator app and leave it plugged in but am concerned about killing my car’s battery.  My next question would be, any recommendations on how to sense if the vehicle is running?">
<meta name="twitter:description" content="Has anyone any experience leaving a Carloop running in a parked vehicle?  I want to deploy my TPMS eliminator app and leave it plugged in but am concerned about killing my car’s battery.  My next question would be, any recommendations on how to sense if the vehicle is running?">
<meta property="article:published_time" content="2016-12-20T22:03:33+00:00">
<meta property="og:ignore_canonical" content="true">


    
  </head>
  <body class="crawler ">
    <div id="top-navbar" class="container">
<span id="top-navbar-links" style="display:none;">
  <a href="https://www.carloop.io" class="dow-menu" id="home"><span id="home-text">Home</span>
  <i class="fa fa-home" aria-hidden="true"></i></a>  
  <a href="https://carloop.readme.io/" class="dow-menu" id="docs">Documentation</a> 
</span>
</div>
    <header>
  <a href="../../index.htm">
    Carloop Community
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="192.html">Leaving a Carloop running</a>
    </h1>


  </div>

  

    <div itemscope="" itemtype='http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Leaving a Carloop running'>
      <link itemprop='url' href='192.html'>
      <meta itemprop='datePublished' content='2016-12-20T22:03:33Z'>
        <meta itemprop='articleSection' content='General Car Talk'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope="" itemtype="http://schema.org/Organization">
        <meta itemprop='name' content='Carloop Community'>
          <div itemprop='logo' itemscope="" itemtype="http://schema.org/ImageObject">
            <meta itemprop='url' content='/uploads/default/original/1X/1c11e9182b98c202a382d6f5862b4cc22c18a478.png'>
          </div>
      </div>


          <div id='post_1' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/clemoyne.html'><span itemprop='name'>clemoyne</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="192.html">


              <span class="crawler-post-infos">
                  <time datetime='2016-12-20T22:03:33Z' class='post-time'>
                    December 20, 2016, 10:03pm
                  </time>
                  <meta itemprop='dateModified' content='2016-12-20T22:03:33Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Has anyone any experience leaving a Carloop running in a parked vehicle?</p>
<p>I want to deploy my TPMS eliminator app and leave it plugged in but am concerned about killing my car’s battery.</p>
<p>My next question would be, any recommendations on how to sense if the vehicle is running?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="0">
              </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/gschmitt.html'><span itemprop='name'>gschmitt</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-12-20T23:09:04Z' class='post-time'>
                    December 20, 2016, 11:09pm
                  </time>
                  <meta itemprop='dateModified' content='2016-12-20T23:09:04Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I suspect you would be drawing less than 100mA of current on average even if you are transmitting regularly.  With that level of current draw you should be able to go several day of not running the vehicle to recharge the battery.</p>
<p>As for sensing if the vehicle is running, you should be able to leverage the voltage of the vehicle with the engine off (~12.5 Volts) is less than when the vehicle is running (~14.2 Volts).  These voltages are way too high to input into a Particle Photon or Electron so you would need to use a voltage divider circuit.  Something like a 4000 ohm resistor in series with a 1000 ohm resistor would work.  The combination of the resistors would be put across the vehicles “12 volt” power with the 4000 ohm resistor connected to positive and the 1000 ohm resistor connected to ground.  Take a lead off of the connection between the two resistors and connect them to one of the analog inputs of the Particle.  You’ll need to test what the analog port reading constitutes the transition from the vehicle being off and on.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="1">
              </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/clemoyne.html'><span itemprop='name'>clemoyne</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-12-21T00:51:05Z' class='post-time'>
                    December 21, 2016, 12:51am
                  </time>
                  <meta itemprop='dateModified' content='2016-12-21T00:51:05Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks for the suggestion, will try it out as soon as I can!  For now I’m just keeping the Carloop handy in case my wife manages to get the car stuck, as Honda brilliantly does not allow you to disable Traction Control if TPMS is not functioning…</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="1">
              </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://carloop.dyndns.org/u/alanm'><span itemprop='name'>alanm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-12-21T01:24:11Z' class='post-time'>
                    December 21, 2016,  1:24am
                  </time>
                  <meta itemprop='dateModified' content='2016-12-21T01:24:11Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hey folks!<br>
Battery voltage comes included in Carloop library.  This sketch shows how to get battery voltage with Carloop library. <a href="https://github.com/carloop/carloop-library/blob/master/firmware/examples/carloop_minimal.cpp">https://github.com/carloop/carloop-library/blob/master/firmware/examples/carloop_minimal.cpp</a></p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="1">
              </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/clemoyne.html'><span itemprop='name'>clemoyne</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2016-12-21T02:44:25Z' class='post-time'>
                    December 21, 2016,  2:44am
                  </time>
                  <meta itemprop='dateModified' content='2016-12-21T02:44:25Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Cool I’m going to try this and see how it works:</p>
<p>void loop() {<br>
// Send a message at a regular time interval<br>
unsigned long now = millis();<br>
unsigned long voltage = carloop.battery();<br>
if ((voltage &gt; 14) &amp;&amp; (now - lastTransmitTime &gt; transmitInterval)) {<br>
WiFi.on();<br>
CANMessage message;</p>
<pre><code>// A CAN message has an ID that identifies the content inside
message.id = 0x333;
// It can have from 0 to 8 data bytes
message.len = 7;

// Pass the data to be transmitted in the data array
message.data[0] = 0x00;
message.data[1] = 0x00;
message.data[2] = 0x00;
message.data[3] = 0x00;
message.data[4] = 0x00;
message.data[5] = 0x00;
message.data[6] = 0x0F;

// Send the message on the bus!
carloop.can().transmit(message);
message.data[6] = 0x1E;
carloop.can().transmit(message);
message.data[6] = 0x2D;
carloop.can().transmit(message);
message.data[6] = 0x3C;
carloop.can().transmit(message);



lastTransmitTime = now;
</code></pre>
<p>}<br>
else{<br>
WiFi.off();<br>
}</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="0">
              </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/Ceer123.html'><span itemprop='name'>Ceer123</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-01-30T15:07:55Z' class='post-time'>
                    January 30, 2017,  3:07pm
                  </time>
                  <meta itemprop='dateModified' content='2017-01-30T15:07:55Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I am working on a project to monitor my Leaf battery and am having trouble keeping the carloop and photon from killing the 12v accessory battery.  With the car parked and off the 12v battery lasts about 12 hours before I can’t start the car.  I put the following check in the code but it is still taking the battery down.  Is there a constant current draw from the carloop when the photon is in deep sleep mode?  Any other suggestions to code around this?</p>
<pre><code class="lang-auto">SYSTEM_MODE(SEMI_AUTOMATIC);

void setup() {
  carloop.begin();
  carloop.update();
  volt = (byte)int((carloop.battery()*100)/8);
  if (volt &lt; 154) { //not enough volts to run 154=12.32v
            System.sleep(SLEEP_MODE_DEEP,90);
  }
  Particle.connect();
}

void loop() {
/*
Program Code (carloop.update() and parsing messages)
*/
    trans[6] = (byte)int((carloop.battery()*100)/8);
    if (trans[6] &lt; 156) { //Go into power save mode 156=12.48v
        if (trans[15] &gt; 0) { //Sleep only if we got a GID value
            logthis("Battery Low, sleeping");
            delay(1000);
            System.sleep(SLEEP_MODE_DEEP,90);
        }
    }
    
    if (trans[15] &gt; 232) {
        logthis("Full Charge going to sleep");
        delay(1000);
        System.sleep(SLEEP_MODE_DEEP,90);
 
    }
}</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="2">
              </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://carloop.dyndns.org/u/alanm'><span itemprop='name'>alanm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-01-31T10:41:38Z' class='post-time'>
                    January 31, 2017, 10:41am
                  </time>
                  <meta itemprop='dateModified' content='2017-01-31T10:41:38Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hey <a class="mention" href="../../u/Ceer123.html">@Ceer123</a>!<br>
If I am reading your code correctly, it looks like you are putting the Photon into <a href="https://docs.particle.io/reference/firmware/photon/#sleep-sleep-">Deep Sleep Mode</a> for about 90 seconds if battery is below 12.32V.  Based on <a href="https://docs.particle.io/datasheets/photon-datasheet/#power">Particle Photon’s Power Consumption Documentation</a>, that should not kill your battery:</p>
<blockquote>
<p>Typical average current consumption is 80mA with 5V @ VIN with Wi-Fi on. Deep sleep quiescent current is typically 80uA (Please refer to Recommended Operating Conditions for more info).</p>
</blockquote>
<p>On a <em><strong>healthy</strong></em> 60Ah 12V battery with no other current drains, a Photon would discharge the battery in approximately 750 hours (31.25 days) with WiFi on.  Do you have the battery-drain problem when Carloop is not connected to the OBD-II port?</p>
<p><a class="mention" href="../../u/ScruffR.html">@ScruffR</a> <a class="mention" href="../../u/jvanier.html">@jvanier</a> any other ideas?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="2">
              </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://carloop.dyndns.org/u/alanm'><span itemprop='name'>alanm</span></a>
                
              </span>


                <link itemprop="image" href="../../uploads/default/original/1X/2239defa56ff24100005094f7fc1d55ecde9f180.png">

              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-01-31T10:46:45Z' class='post-time'>
                    January 31, 2017, 10:46am
                  </time>
                  <meta itemprop='dateModified' content='2017-01-31T10:52:02Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Here’s an interesting <a href="https://docs.particle.io/datasheets/photon-datasheet/#recommended-operating-conditions">operating current table</a> based on different modes:</p>
<p><img src="//carloop-community.dyndns.org/uploads/default/original/1X/2239defa56ff24100005094f7fc1d55ecde9f180.png" width="655" height="499"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="0">
              </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/ScruffR.html'><span itemprop='name'>ScruffR</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-01-31T11:28:24Z' class='post-time'>
                    January 31, 2017, 11:28am
                  </time>
                  <meta itemprop='dateModified' content='2017-01-31T11:28:24Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>What capacity has your 12V battery?</p>
<p>In addition to this</p>
<aside class="quote no-group" data-username="alanm" data-post="7" data-topic="192">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="//carloop-community.dyndns.org/user_avatar/carloop-community.dyndns.org/alanm/48/428_2.png" class="avatar"> alanm:</div>
<blockquote>
<p>Do you have the battery-drain problem when Carloop is not connected to the OBD-II port?</p>
</blockquote>
</aside>
<p>Does it make a difference whether the Photon is plugged into the CarLoop or not?<br>
I would doubt that the Photon would drain a few Ah capacity battery that quickly, especially when being asleep for most of the time.<br>
Do you see the device going to sleep properly?</p>
<p>BTW, where is the <code>carloop.update()</code> call in <code>loop()</code>?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="1">
              </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/Ceer123.html'><span itemprop='name'>Ceer123</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-02-01T13:46:22Z' class='post-time'>
                    February 1, 2017,  1:46pm
                  </time>
                  <meta itemprop='dateModified' content='2017-02-01T13:46:22Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks for the replies.</p>
<p>I believe the Leaf battery is smaller than normal cars at about 40Ah.  That still should be enough to power through a day at least.</p>
<p>I did some current measurements on the carloop.  With the carloop only (photon removed) it pulls 2mA.  When adding the photon that is connected to wifi it was about 37mA.  I assume those are within normal expectations.</p>
<p>I did find a possible issue with my code that would prevent the photon from going to sleep.  In the normal loop I was checking the battery and going to sleep if I had a value (GID) from the car.  However it looks like the car, seemingly at will, will shut down the canbus which would prevent my program from getting that value so the power save would never trigger.  I have commented out that check and will now do a powersave based only on the battery voltage.</p>
<p>The carloop.update() is at the beginning of the loop after I check if the wifi is still connected.  I do see it going to sleep like it should during my testing.</p>
<p>One other thought - Is it possible the carloop is keeping the car computer alive when it would normal not be?  I am not writing anything to the bus, the car spits out everything I need without asking.  I haven’t figured out why the can messages start and stop on the bus yet.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="1">
              </div>

          </div>
          <div id='post_11' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/ScruffR.html'><span itemprop='name'>ScruffR</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-02-01T15:24:16Z' class='post-time'>
                    February 1, 2017,  3:24pm
                  </time>
                  <meta itemprop='dateModified' content='2017-02-01T15:24:16Z'>
              <span itemprop='position'>11</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Ceer123" data-post="10" data-topic="192">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="//carloop-community.dyndns.org/letter_avatar_proxy/v4/letter/c/d07c76/48.png" class="avatar"> Ceer123:</div>
<blockquote>
<p>The carloop.update() is at the beginning of the loop after I check if the wifi is still connected.</p>
</blockquote>
</aside>
<p>Not in the code you have shown above.</p>
<aside class="quote no-group quote-modified" data-username="Ceer123" data-post="6" data-topic="192">
<div class="title">
<div class="quote-controls"></div>
<img loading="lazy" alt="" width="24" height="24" src="//carloop-community.dyndns.org/letter_avatar_proxy/v4/letter/c/d07c76/48.png" class="avatar"> Ceer123:</div>
<blockquote>
<pre data-code-wrap="cpp"><code class="lang-cpp">void loop() {
/*
Program Code (carloop.update() and parsing messages)
*/
    trans[6] = (byte)int((carloop.battery()*100)/8);
    ...
</code></pre>
</blockquote>
</aside>
<p>The line is commented and never executing that way.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="0">
              </div>

          </div>
          <div id='post_12' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/Ceer123.html'><span itemprop='name'>Ceer123</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-02-01T23:19:27Z' class='post-time'>
                    February 1, 2017, 11:19pm
                  </time>
                  <meta itemprop='dateModified' content='2017-02-01T23:19:27Z'>
              <span itemprop='position'>12</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Right, I was just showing that to keep the post simple.  That Program Code section is where the 200+ lines of parsing the can messages is in the main loop.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="1">
              </div>

          </div>
          <div id='post_13' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='https://carloop.dyndns.org/u/alanm'><span itemprop='name'>alanm</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-02-06T18:38:45Z' class='post-time'>
                    February 6, 2017,  6:38pm
                  </time>
                  <meta itemprop='dateModified' content='2017-02-06T18:38:45Z'>
              <span itemprop='position'>13</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hey <a class="mention" href="../../u/Ceer123.html">@Ceer123</a>,<br>
Did you figure out what was draining your battery?  Would love to know how it went!</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="0">
              </div>

          </div>
          <div id='post_14' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/Ceer123.html'><span itemprop='name'>Ceer123</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-02-06T18:56:09Z' class='post-time'>
                    February 6, 2017,  6:56pm
                  </time>
                  <meta itemprop='dateModified' content='2017-02-06T18:56:09Z'>
              <span itemprop='position'>14</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I ran this weekend with the carloop connected and not starting the car for two days and the battery was fine.  I think the code I commented out where I was waiting for a CAN message before going to sleep fixed it.  However it is apparent that if the photon is connected without sleeping it will drain the battery about 12 hours.  I believe the battery is original on the car and is four years old now so it is possible the battery capacity is not as good as it should be.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="1">
              </div>

          </div>
          <div id='post_15' itemprop='comment' itemscope="" itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href='../../u/HuskerJeff.html'><span itemprop='name'>HuskerJeff</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2017-03-16T15:07:19Z' class='post-time'>
                    March 16, 2017,  3:07pm
                  </time>
                  <meta itemprop='dateModified' content='2017-03-16T15:07:19Z'>
              <span itemprop='position'>15</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hi <a class="mention" href="../../u/Ceer123.html">@Ceer123</a> - I found carloop while looking for a solution for exactly what you seem to be doing - remote monitoring SoC on my Nissan Leaf.  Can you comment on what you’ve done so far and how its working for you?  If you have a blog or other page that documents your project, could you include that too please?</p>
<p>Depending on the level of success you’re having, I’d definitely like to make use of and contribute to your project.</p>
<p>Thanks!<br>
Jeff</p>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="http://schema.org/LikeAction">
              <meta itemprop="userInteractionCount" content="0">
              <span class='post-likes'></span>
            </div>

            <div itemprop="interactionStatistic" itemscope="" itemtype="http://schema.org/InteractionCounter">
                <meta itemprop="interactionType" content="http://schema.org/CommentAction">
                <meta itemprop="userInteractionCount" content="0">
              </div>

          </div>
    </div>


  




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope="" itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.htm' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope="" itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/categories' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope="" itemtype='http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='/guidelines' itemprop="url">FAQ/Guidelines </a>
        </span>
      </li>
        <li itemscope="" itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/tos' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope="" itemtype='http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='/privacy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="https://www.discourse.org">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    
    
  </body>
  
</html>
